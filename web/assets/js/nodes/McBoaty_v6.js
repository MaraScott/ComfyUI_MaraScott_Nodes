const t={async setPrompts(t){const a=(Array.isArray(t.graph.links)?t.graph.links:Object.values(t.graph.links)).find(a=>(null==a?void 0:a.id)==t.inputs[0].link);if(null!=a){const e=t.widgets.find(t=>"refresh_prompts"===t.name),o=t.widgets.find(t=>"tiles_to_process"===t.name),n=t.widgets.find(t=>"positive"===t.name),s=t.widgets.find(t=>"negative"===t.name),i=async t=>{try{const e=await fetch("/marascott/McBoaty_v6/get_prompts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tiles:t,parentId:a.origin_id})});return e.ok?await e.json():[]}catch(e){return[]}},c=async()=>{n.value,s.value;const t=null!=o?o.value:"",a=await i(t);""==n.value&&(n.value=a.positive),""==s.value&&(s.value=a.negative),setTimeout(()=>{e.value=!1},50)},l=async()=>{e.value=!0,c()};null!=o&&(o.callback=l),e.callback=c;const r=async()=>{};await r(),await l()}},async setModels(t){const a=t.widgets.find(t=>"ollama_url"===t.name),e=t.widgets.find(t=>"vlm_model"===t.name),o=async()=>{const t=a.value,o=e.value;e.value="",e.options.values=[];const n=await(async t=>{try{const a=await fetch("/marascott/ollama/get_models",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:t})});return a.ok?await a.json():[]}catch(a){return[]}})(t);e.options.values=n,n.includes(o)?e.value=o:n.length>0&&(e.value=n[0])};a.callback=o,await(async()=>{})(),await o()}},a=a=>({name:"ComfyUI.MaraScott.McBoaty_v6",async loadedGraphNode(a,e){["MaraScottMcBoatyTilePrompter_v6","MaraScottUntiler_v1"].includes(a.type)&&t.setPrompts(a)},async beforeRegisterNodeDef(a,e,o){if(["MaraScottMcBoatyConfigurator_v6","MaraScottMcBoaty_v6"].includes(e.name)){const e=a.prototype.onNodeCreated;a.prototype.onNodeCreated=async function(){e&&e.apply(this,arguments),t.setModels(this)}}if(["MaraScottMcBoatyTilePrompter_v6"].includes(e.name)){const e=a.prototype.onConnectionsChange;a.prototype.onConnectionsChange=async function(a,o,n,s,i){e&&e.apply(this,arguments),t.setPrompts(this)};const o=a.prototype.onExecuted;a.prototype.onExecuted=function(a){o&&(o.apply(this,arguments),t.setPrompts(this))}}}});export{a as MaraScottMcBoaty_v6};
